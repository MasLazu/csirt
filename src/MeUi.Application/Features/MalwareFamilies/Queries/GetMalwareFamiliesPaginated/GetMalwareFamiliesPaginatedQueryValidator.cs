using FluentValidation;
using MeUi.Application.Models;

namespace MeUi.Application.Features.MalwareFamilies.Queries.GetMalwareFamiliesPaginated;

public class GetMalwareFamiliesPaginatedQueryValidator : AbstractValidator<GetMalwareFamiliesPaginatedQuery>
{
    public GetMalwareFamiliesPaginatedQueryValidator()
    {
        Include(new BasePaginatedQueryValidator<MalwareFamilyDto>());

        RuleFor(x => x.SortBy)
            .Must(sortBy => string.IsNullOrEmpty(sortBy) || 
                           new[] { "name", "createdat", "updatedat" }.Contains(sortBy.ToLowerInvariant()))
            .WithMessage("SortBy must be one of: Name, CreatedAt, UpdatedAt");
    }
}
