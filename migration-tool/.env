# MongoDB Configuration - optimized high throughput (avoid oversized pools)
MONGO_URI=mongodb://10.0.0.253:27017/?maxPoolSize=200&minPoolSize=40&maxIdleTimeMS=10000&serverSelectionTimeoutMS=3000&socketTimeoutMS=45000&readPreference=secondaryPreferred&readConcern=local&w=0
MONGO_DATABASE=csrit
MONGO_COLLECTION=ThreatIntelligence

# PostgreSQL Configuration
POSTGRES_HOST=10.0.0.107
POSTGRES_PORT=5432
POSTGRES_DATABASE=csrit-2
POSTGRES_USERNAME=postgres
POSTGRES_PASSWORD=FazizHomelab4212
POSTGRES_SSLMODE=disable

# Migration Configuration - tuned
# Batch size: large enough for COPY efficiency, small enough for memory & latency
MIGRATION_BATCH_SIZE=40000
# Worker count: concurrent transform workers (too many adds contention)
MIGRATION_WORKER_COUNT=16
# Buffered batches waiting for workers (keep modest to cap memory)
MIGRATION_BUFFER_SIZE=64
# DB connection pool (roughly workers + COPY + spare)
MIGRATION_CONNECTION_POOL_SIZE=64
# Retries for transient DB/network issues
MIGRATION_MAX_RETRIES=3
MIGRATION_RETRY_DELAY_SECONDS=2
# Timeout per batch (seconds)
MIGRATION_BATCH_TIMEOUT_SECONDS=600
# Progress report interval (seconds)
MIGRATION_PROGRESS_REPORT_INTERVAL=5

# COPY / Adaptive ingestion tuning
MIGRATION_USE_COPY=true
# Switch to COPY once batch >= threshold
MIGRATION_COPY_THRESHOLD=5000
# Enable adaptive threshold adjustments
MIGRATION_COPY_ADAPTIVE=true
# Adaptive min / max thresholds
MIGRATION_COPY_MIN_THRESHOLD=2000
MIGRATION_COPY_MAX_THRESHOLD=60000
# Target rows per second (guiding metric for future adaptive logic)
MIGRATION_COPY_TARGET_RPS=30000
# Optional staging table (leave blank - feature not implemented yet)
MIGRATION_COPY_TEMP_TABLE=
# Disable non-critical indexes during load (not implemented yet, keep false)
MIGRATION_DISABLE_INDEXES=false
# Dry run (set true for validation run without writes)
MIGRATION_DRY_RUN=false

# System Optimizations
# Let Go auto-size to CPUs
GOMAXPROCS=0
# Higher GOGC reduces GC frequency for large batches
GOGC=200
# Memory soft limit
GOMEMLIMIT=16GiB